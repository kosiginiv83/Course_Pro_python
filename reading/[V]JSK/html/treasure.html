<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>xxx3</title>
	</head>
	<body>
		<h1 id="heading">Найди клад</h1>
		<img id="map" width=400 height=400
			src="http://nostarch.com/images/treasuremap.png">
		<p id="clickRem">Осталось кликов: </p>
		<p id="clickRemRes"></p>
		<p id="distance"></p>
		<script src="https://code.jquery.com/jquery-2.1.0.js"></script>
		
		<script>
			var width = 400;
			var height = 400;
			var clicks = 0;
			var diffX = 0;
			var diffY = 0;
			var clicksRem = 30;
			$("#clickRemRes").text(clicksRem);
			
			var getRandomNumber = function (size) {
				return Math.floor(Math.random() * size);
			};
			
			var getDistance = function (event, target) {
				var diffX = event.offsetX - target.x;
				var diffY = event.offsetY - target.y;
				return Math.sqrt(Math.pow(diffX, 2) + Math.pow(diffY, 2));
			};
			
			var getDistanceHint = function (distance) {
				if (distance < 10) {
					return "Обожжешься";
				} else if (distance < 20) {
					return "Очень горячо";
				} else if (distance < 40) {
					return "Горячо";
				} else if (distance < 80) {
					return "Тепло";
				} else if (distance < 160) {
					return "Холодно";
				} else if (distance < 320) {
					return "Очень холодно";
				} else {
					return "Замерзнешь";
				}
			};
			
			var target = {
				x: getRandomNumber(width),
				y: getRandomNumber(height)
			};
			
			$('#map').click( function (event) {
				clicks++;
				clicksRem--;
				$("#clickRemRes").text(clicksRem);
				if (clicksRem === 0) {
					$("#map").hide();
					$("#heading").text("Конец игры");
				}
				var distance = getDistance(event, target);
				var distanceHint = getDistanceHint(distance);
				$("#distance").text(distanceHint);
				if (distance < 8) {
					alert("Клад найден. Сделано кликов: " + clicks);
					$("#map").hide();
					$("#heading").text("Вы выиграли");
				}
			});
		</script>
	</body>
</html>